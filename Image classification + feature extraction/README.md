# Weather Image Classification & Feature Extraction

This project performs image classification on a weather dataset using a combination of deep learning feature extraction (Img2Vec) and a classical machine learning classifier (Random Forest).

## Project Structure
- `dataset2/`: The original unorganized dataset containing images.
- `data/`: The organized dataset (generated by `prepare_data.py`).
- `main.py`: The training script that extracts features and trains the Random Forest model.
- `infer.py`: The inference script to classify new images.
- `prepare_data.py`: A utility script to split the dataset into training and validation sets.
- `requirements.txt`: List of Python dependencies.
- `model.p`: The trained model file (saved after running `main.py`).

## Features
- **Feature Extraction**: Uses `img2vec_pytorch` to leverage pre-trained PyTorch models (ResNet-18 by default) for high-quality feature vectors.
- **Classification**: Uses Scikit-learn's `RandomForestClassifier` for robust prediction.
- **Easy Deployment**: Includes scripts for both training and individual image inference.

## Getting Started

### 1. Install Dependencies
Ensure you have Python installed, then run:
```bash
pip install -r requirements.txt
```

### 2. Prepare the Data
The dataset in `dataset2` needs to be organized into a structured format for training. Run the preparation script:
```bash
python prepare_data.py
```
This will create a `data/weather_dataset` folder with 80/20 train/val split.

### 3. Train the Model
Run the main training script to extract features and train the classifier:
```bash
python main.py
```
This will output the validation accuracy and save the trained model as `model.p`.

### 4. Run Inference
To classify a specific image, use the inference script:
```bash
python infer.py --image path/to/your/image.jpg
```

## Technologies Used
- **Python**
- **PyTorch** & **Torchvision** (via Img2Vec)
- **Scikit-learn** (Random Forest, accuracy metrics)
- **Pillow** (Image processing)
- **Img2Vec-Pytorch**
